function cov_4es8dnen0(){var path="/home/douglas/Documentos/estudos/promises-generatos-iterators/src/request.js";var hash="ddd2ce725f8d0bf29b0bb40798a36e567beae985";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/douglas/Documentos/estudos/promises-generatos-iterators/src/request.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:30}},"1":{start:{line:3,column:0},end:{line:45,column:2}},"2":{start:{line:4,column:17},end:{line:5,column:54}},"3":{start:{line:4,column:41},end:{line:5,column:54}},"4":{start:{line:5,column:4},end:{line:5,column:54}},"5":{start:{line:8,column:4},end:{line:10,column:7}},"6":{start:{line:9,column:6},end:{line:9,column:58}},"7":{start:{line:14,column:4},end:{line:36,column:7}},"8":{start:{line:15,column:6},end:{line:35,column:29}},"9":{start:{line:17,column:24},end:{line:17,column:26}},"10":{start:{line:18,column:10},end:{line:33,column:15}},"11":{start:{line:20,column:14},end:{line:20,column:31}},"12":{start:{line:23,column:41},end:{line:23,column:55}},"13":{start:{line:24,column:14},end:{line:31,column:15}},"14":{start:{line:25,column:16},end:{line:30,column:18}},"15":{start:{line:32,column:14},end:{line:32,column:54}},"16":{start:{line:40,column:4},end:{line:43,column:7}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:4,column:17},end:{line:4,column:18}},loc:{start:{line:4,column:41},end:{line:5,column:54}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:4,column:41},end:{line:4,column:42}},loc:{start:{line:5,column:4},end:{line:5,column:54}},line:5},"2":{name:"(anonymous_2)",decl:{start:{line:7,column:2},end:{line:7,column:3}},loc:{start:{line:7,column:33},end:{line:11,column:3}},line:7},"3":{name:"(anonymous_3)",decl:{start:{line:8,column:23},end:{line:8,column:24}},loc:{start:{line:8,column:44},end:{line:10,column:5}},line:8},"4":{name:"(anonymous_4)",decl:{start:{line:13,column:2},end:{line:13,column:3}},loc:{start:{line:13,column:17},end:{line:37,column:3}},line:13},"5":{name:"(anonymous_5)",decl:{start:{line:14,column:23},end:{line:14,column:24}},loc:{start:{line:14,column:44},end:{line:36,column:5}},line:14},"6":{name:"(anonymous_6)",decl:{start:{line:16,column:18},end:{line:16,column:19}},loc:{start:{line:16,column:27},end:{line:34,column:9}},line:16},"7":{name:"(anonymous_7)",decl:{start:{line:19,column:24},end:{line:19,column:25}},loc:{start:{line:19,column:34},end:{line:21,column:13}},line:19},"8":{name:"(anonymous_8)",decl:{start:{line:22,column:23},end:{line:22,column:24}},loc:{start:{line:22,column:29},end:{line:33,column:13}},line:22},"9":{name:"(anonymous_9)",decl:{start:{line:39,column:2},end:{line:39,column:3}},loc:{start:{line:39,column:46},end:{line:44,column:3}},line:39}},branchMap:{"0":{loc:{start:{line:24,column:14},end:{line:31,column:15}},type:"if",locations:[{start:{line:24,column:14},end:{line:31,column:15}},{start:{line:24,column:14},end:{line:31,column:15}}],line:24}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"ddd2ce725f8d0bf29b0bb40798a36e567beae985"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_4es8dnen0=function(){return actualCoverage;};}return actualCoverage;}cov_4es8dnen0();const https=(cov_4es8dnen0().s[0]++,require('https'));cov_4es8dnen0().s[1]++;module.exports=class Request{errorTimeout=(cov_4es8dnen0().s[2]++,(reject,urlRequest)=>{cov_4es8dnen0().f[0]++;cov_4es8dnen0().s[3]++;return()=>{cov_4es8dnen0().f[1]++;cov_4es8dnen0().s[4]++;return reject(new Error(`timeout at [${urlRequest}] :(`));};});raceTimeoutDelay(url,timeout){cov_4es8dnen0().f[2]++;cov_4es8dnen0().s[5]++;return new Promise((resolve,reject)=>{cov_4es8dnen0().f[3]++;cov_4es8dnen0().s[6]++;setTimeout(this.errorTimeout(reject,url),timeout);});}async get(url){cov_4es8dnen0().f[4]++;cov_4es8dnen0().s[7]++;return new Promise((resolve,reject)=>{cov_4es8dnen0().f[5]++;cov_4es8dnen0().s[8]++;https.get(url,res=>{cov_4es8dnen0().f[6]++;const items=(cov_4es8dnen0().s[9]++,[]);cov_4es8dnen0().s[10]++;res.on('data',data=>{cov_4es8dnen0().f[7]++;cov_4es8dnen0().s[11]++;items.push(data);}).on('end',()=>{cov_4es8dnen0().f[8]++;const stringifiedReponse=(cov_4es8dnen0().s[12]++,items.join(''));cov_4es8dnen0().s[13]++;if(!stringifiedReponse.length){cov_4es8dnen0().b[0][0]++;cov_4es8dnen0().s[14]++;throw new Error(JSON.stringify({error:true,message:'Received empty response'}));}else{cov_4es8dnen0().b[0][1]++;}cov_4es8dnen0().s[15]++;resolve(JSON.parse(stringifiedReponse));});}).on('error',reject);});}async makeRequest({url,method,timeout}){cov_4es8dnen0().f[9]++;cov_4es8dnen0().s[16]++;return Promise.race([this[method](url),this.raceTimeoutDelay(url,timeout)]);}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlcXVlc3QuanMiXSwibmFtZXMiOlsiaHR0cHMiLCJyZXF1aXJlIiwibW9kdWxlIiwiZXhwb3J0cyIsIlJlcXVlc3QiLCJlcnJvclRpbWVvdXQiLCJyZWplY3QiLCJ1cmxSZXF1ZXN0IiwiRXJyb3IiLCJyYWNlVGltZW91dERlbGF5IiwidXJsIiwidGltZW91dCIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsImdldCIsInJlcyIsIml0ZW1zIiwib24iLCJkYXRhIiwicHVzaCIsInN0cmluZ2lmaWVkUmVwb25zZSIsImpvaW4iLCJsZW5ndGgiLCJKU09OIiwic3RyaW5naWZ5IiwiZXJyb3IiLCJtZXNzYWdlIiwicGFyc2UiLCJtYWtlUmVxdWVzdCIsIm1ldGhvZCIsInJhY2UiXSwibWFwcGluZ3MiOiJ5MEdBZVk7eUZBZlosS0FBTUEsQ0FBQUEsS0FBSyx5QkFBR0MsT0FBTyxDQUFDLE9BQUQsQ0FBVixDQUFYLEMsdUJBRUFDLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixLQUFNQyxDQUFBQSxPQUFRLENBQzdCQyxZQUFZLHlCQUFHLENBQUNDLE1BQUQsQ0FBU0MsVUFBVCxHQUF3Qix5REFDckMscURBQUFELENBQUFBLE1BQU0sQ0FBQyxHQUFJRSxDQUFBQSxLQUFKLENBQVcsZUFBY0QsVUFBVyxNQUFwQyxDQUFELENBQU4sQ0FBa0QsQ0FEYixDQUNhLENBRHhDLEVBR1pFLGdCQUFnQixDQUFDQyxHQUFELENBQU1DLE9BQU4sQ0FBZSwrQ0FDN0IsTUFBTyxJQUFJQyxDQUFBQSxPQUFKLENBQVksQ0FBQ0MsT0FBRCxDQUFVUCxNQUFWLEdBQXFCLCtDQUN0Q1EsVUFBVSxDQUFDLEtBQUtULFlBQUwsQ0FBa0JDLE1BQWxCLENBQTBCSSxHQUExQixDQUFELENBQWlDQyxPQUFqQyxDQUFWLENBQ0QsQ0FGTSxDQUFQLENBR0QsQ0FFUSxLQUFISSxDQUFBQSxHQUFHLENBQUNMLEdBQUQsQ0FBTSwrQ0FDYixNQUFPLElBQUlFLENBQUFBLE9BQUosQ0FBWSxDQUFDQyxPQUFELENBQVVQLE1BQVYsR0FBcUIsK0NBQ3RDTixLQUFLLENBQ0ZlLEdBREgsQ0FDT0wsR0FEUCxDQUNhTSxHQUFELEVBQVMsd0JBQ2pCLEtBQU1DLENBQUFBLEtBQUsseUJBQUcsRUFBSCxDQUFYLENBRGlCLHdCQUVqQkQsR0FBRyxDQUNBRSxFQURILENBQ00sTUFETixDQUNlQyxJQUFELEVBQVUsZ0RBQ3BCRixLQUFLLENBQUNHLElBQU4sQ0FBV0QsSUFBWCxFQUNELENBSEgsRUFJR0QsRUFKSCxDQUlNLEtBSk4sQ0FJYSxJQUFNLHdCQUNmLEtBQU1HLENBQUFBLGtCQUFrQiwwQkFBR0osS0FBSyxDQUFDSyxJQUFOLENBQVcsRUFBWCxDQUFILENBQXhCLENBRGUsd0JBRWYsR0FBSSxDQUFDRCxrQkFBa0IsQ0FBQ0UsTUFBeEIsQ0FBZ0MsbURBQzlCLEtBQU0sSUFBSWYsQ0FBQUEsS0FBSixDQUNKZ0IsSUFBSSxDQUFDQyxTQUFMLENBQWUsQ0FDYkMsS0FBSyxDQUFFLElBRE0sQ0FFYkMsT0FBTyxDQUFFLHlCQUZJLENBQWYsQ0FESSxDQUFOLENBTUQsQ0FQRCxnQ0FGZSx3QkFVZmQsT0FBTyxDQUFDVyxJQUFJLENBQUNJLEtBQUwsQ0FBV1Asa0JBQVgsQ0FBRCxDQUFQLENBQ0QsQ0FmSCxFQWdCRCxDQW5CSCxFQW9CR0gsRUFwQkgsQ0FvQk0sT0FwQk4sQ0FvQmVaLE1BcEJmLEVBcUJELENBdEJNLENBQVAsQ0F1QkQsQ0FFZ0IsS0FBWHVCLENBQUFBLFdBQVcsQ0FBQyxDQUFFbkIsR0FBRixDQUFPb0IsTUFBUCxDQUFlbkIsT0FBZixDQUFELENBQTJCLGdEQUMxQyxNQUFPQyxDQUFBQSxPQUFPLENBQUNtQixJQUFSLENBQWEsQ0FDbEIsS0FBS0QsTUFBTCxFQUFhcEIsR0FBYixDQURrQixDQUVsQixLQUFLRCxnQkFBTCxDQUFzQkMsR0FBdEIsQ0FBMkJDLE9BQTNCLENBRmtCLENBQWIsQ0FBUCxDQUlELENBekM0QixDQUEvQiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGh0dHBzID0gcmVxdWlyZSgnaHR0cHMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBjbGFzcyBSZXF1ZXN0IHtcbiAgZXJyb3JUaW1lb3V0ID0gKHJlamVjdCwgdXJsUmVxdWVzdCkgPT4gKCkgPT5cbiAgICByZWplY3QobmV3IEVycm9yKGB0aW1lb3V0IGF0IFske3VybFJlcXVlc3R9XSA6KGApKTtcblxuICByYWNlVGltZW91dERlbGF5KHVybCwgdGltZW91dCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBzZXRUaW1lb3V0KHRoaXMuZXJyb3JUaW1lb3V0KHJlamVjdCwgdXJsKSwgdGltZW91dCk7XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBnZXQodXJsKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGh0dHBzXG4gICAgICAgIC5nZXQodXJsLCAocmVzKSA9PiB7XG4gICAgICAgICAgY29uc3QgaXRlbXMgPSBbXTtcbiAgICAgICAgICByZXNcbiAgICAgICAgICAgIC5vbignZGF0YScsIChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgIGl0ZW1zLnB1c2goZGF0YSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLm9uKCdlbmQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHN0cmluZ2lmaWVkUmVwb25zZSA9IGl0ZW1zLmpvaW4oJycpO1xuICAgICAgICAgICAgICBpZiAoIXN0cmluZ2lmaWVkUmVwb25zZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnUmVjZWl2ZWQgZW1wdHkgcmVzcG9uc2UnLFxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJlc29sdmUoSlNPTi5wYXJzZShzdHJpbmdpZmllZFJlcG9uc2UpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KVxuICAgICAgICAub24oJ2Vycm9yJywgcmVqZWN0KTtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIG1ha2VSZXF1ZXN0KHsgdXJsLCBtZXRob2QsIHRpbWVvdXQgfSkge1xuICAgIHJldHVybiBQcm9taXNlLnJhY2UoW1xuICAgICAgdGhpc1ttZXRob2RdKHVybCksXG4gICAgICB0aGlzLnJhY2VUaW1lb3V0RGVsYXkodXJsLCB0aW1lb3V0KSxcbiAgICBdKTtcbiAgfVxufTtcbiJdfQ==